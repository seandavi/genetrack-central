{% extends "base.html" %}

{% block title %}Project List{% endblock %}

{% block header %}<h2>Project: {{project.name}}</h2>{% endblock %}

{% block local-headers%}

<script>

    function filter_projects(){
        // displays project based on the content of the filterbox
        var text = $("#filter-input").val().toLowerCase();
        if (text.length == 0) {
            $(".row").show();
            $('#filter-box').removeClass("notice")
            $('#filter-text').html('')

        } else {
            $(".row").hide();
            $('#filter-box').addClass("notice")
            $('#filter-text').html(' &bull; filtered with "' + text + '"')
            $(".row:contains('" + text +"')").show()
        }
    }

    $(document).ready(function(){
        // $("div:contains('John')").css("text-decoration", "underline");
        
        // filter the project rows based on the filter box
        $("#filter-input").keyup( filter_projects ); 

        // searchbox gets focus
        $("#filter-input").focus()

        // run the project filter on page load

        filter_projects()
        // highlits data rows on mouse hover
        $(".row").hover( function() {
                $(this).addClass("hover")
            }, function() {
                $(this).removeClass("hover")
            }
        )
    
        // makes entire row clickable
        $(".row").click(function(){
            window.location=$(this).find("a").attr("href"); return false;
        });



    });
</script>

{% endblock %}

{% block mainbody %}

  <!-- main box left -->
  <div class="span-17 colborder" id="content">

      {% for p in projects %}
          <div class="project row quiet">
            <div class="project name">Project: <a href="/project/view/{{p.id}}">{{p.name}}</a></div>
            <div class="project status">Your role {{p.role}} &bull; 0 {{p.size}} datasets.</div>
          </div>
          
      {% endfor %}
      <div>&nbsp;</div>
      
  </div>

  <!-- left sidebar -->
  <div class="span-6 last" id="sidebar">
    <div>
      <h3 class="caps">Your Account</h3>
      <div class="box">
          <div class="quiet">Logged in as <b>{{user.get_full_name}}</b></div>
          <div>
            <a href="/project/list">Project list</a> &bull; 
            <a href="/">Home page</a> &bull; 
            <a href="/logout">Log out</a>
          </div>
      </div>
    </div>

    {% if project.is_manager %}
    <div>
      <h3 class="caps">Modify Project</h3>
      <div class="box">
          <div class="quiet" align="center">
          <a href="/project/edit/{{project.id}}/">Modify Project</a>
          &bull; 
          <a href="/project/delete/{{project.id}}/">Delete Project</a></div>
      </div>
    </div>
    {% endif %}

    <div>
      <h3 class="caps">Filter Data</h3>
      <div class="box" id="filter-box">
          <div class="quiet">Filter data by showing only 
          the names that match the text in the box below</div>
          <div class="quiet" >
            <span class="search">
              <input type="text" size="20" id="filter-input" style="margin-left:20px;">
            </span>
          </div>
      </div>
    </div>

    {% if user.is_superuser %}
    <div>
      <h3 class="caps">Admin Tools</h3>
      <div class="box">
          <div class="quiet">This account has administration privileges</div>
          <div style="padding-left:20px">
            <div class="quiet"> &bull <a href="#" class="quiet">access user list</a></div>
            <div class="quiet"> &bull <a href="#" class="quiet">access job queue</a></div>
            <div class="quiet"> &bull <a href="#" class="quiet">access server status</a></div>
          </div>
      </div>
    </div>
    {% endif %}

  </div>

{% endblock %}

