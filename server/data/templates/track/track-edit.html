{% extends "base.html" %}
{% load boxes %}

{% block title %}{{title}}{% endblock %}

{% block header %}<h2 align="center">{{param.title}}</h2>{% endblock %}

{% block local-headers%}

<script>
    
    $(document).ready(function(){

        // makes entire row clickable
        $("#add-button").click(function(){

            var json = $("#json")
            var currval = json.val()
            var newval = currval + "color=RED; glyph=AUTO; data=45; row=NEW;\n"

            var lines = currval.split("\n").length

            //debugger
            //newval = currval + '\n' + lines
            json.val( newval )

        });

        $("#help-panel").hide()
        $("#help-link").click(function(){
            $("#help-panel").toggle('fast')
        });

    });
</script>

{% endblock %}

{% block mainbody %}

<form method="post" action="/track/edit/{{param.pid}}/{{param.tid}}/" id="mainform">

    <!-- left sidebar -->
    <div class="span-2">&nbsp;</div>

    <div class="span-20">
        <div id="test"> VALUE</div>

        <fieldset id="login" class="box">
            <legend>Track details</legend>
            
            <div>
                {% if param.data %}

                <div class="capsx">NAME</div>
                {{form.name.errors }}
                <div class="pad10">{{form.name}}</div>
                
                <div class="capsx">DATA</div>
                <div class="pad10">
                    
                    <select name="did">
                        {% for data in param.data %}
                            <option value="{{data.id}}">{{data.name}} (id={{data.id}})</option>
                        {% endfor %}
                    </select>
                    <input type="button" name="add" id="add-button" value="Add"/> {% sep %} click to add the selected data to the tracks
                </div>

                <div class="capsx">TRACKS</div>
                {{form.text.errors }}
                <div class="pad10">{{form.text}}</div>

                <div class="pad10">
                   <div>
                        Help on <a id="help-link" href="#">track options</a>
                   </div>
                   <div id="help-panel">
                        <blockquote>
                        <pre>
                    --- Required attributes ---

    color -> RED, GREEN, BLUE, WHITE, BLACK, PURPLE, ORANGE ... or a hexcolor #FAFACC
    glyph -> AUTO, ORF, INTERVAL, ARROW, BOOKMARK
    data  -> <number> the id of the data (filled in when clicking Add)

                    --- Optional attributes ---

    label   -> text (the label for the track, left)
    label2  -> text (label on the second axis, right)
    color2  -> see color (color for secondary data, fit)
    row     -> NEW, SAME (what row will the track will go)
    layer   -> number (the order of drawing within a row)
    alpha   -> percent (the transparency of the track)
    offset  -> number multiple tracks may be shifted vertically
    height  -> number the height of the track in pixels

                   --- Action attributes ---

    subtract -> data id (subtract this data)
    divide   -> data id (divide with this data)
    minimum  -> value (filters data below this minimum)
    fitting  -> yes, no (wether or not to enable fitting for this track)
    predict  -> yes, no (wether to generate extra prediction tracks)
    </pre>
                        </blockquote>
                        <h5>
                            Options are explained on the <a href="http://genetrack.bx.psu.edu/trackoptions.html">track options</a> page</h5>
                    </div>
                </div>

                <div class="pad10">
                    <input type="button" name="add" value="Preview Track"/> 
                    &nbsp;&nbsp;|&nbsp;&nbsp;
                    <input type="submit" name="submit" value="{{param.btn_name}}"/> &nbsp;&nbsp;|&nbsp;&nbsp;
                    <input type="button" name="cancel" value="Project View" onclick='javascript:window.location="/project/view/{{param.pid}}/"'/>
                </div>
                {% else %}
                    <div class="notice" align="center">
                        <h3>
                            This project does not contain data that can be visualized!
                        <h3>
                        <h3>See more information on the <a href="http://genetrack.bx.psu.edu/">GeneTrack site</a></h3>
                        <h4>Back to <a href="/project/view/{{param.pid}}/">Project View</a></h4>
                    </div>
                {% endif %}
            </div>

        </fieldset>
    </div>

    <div class="span-2 last">&nbsp;</div>

</form>

{% endblock %}
